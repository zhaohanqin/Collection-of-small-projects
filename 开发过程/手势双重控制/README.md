# 🎮 手势双重控制器

## 📖 项目简介

这是一个结合了手势控制音量和亮度功能的双重控制项目。通过摄像头检测用户的左右手手势，实现：

- **左手控制音量**：拇指和食指的距离控制系统音量大小
- **右手控制亮度**：拇指和食指的距离控制屏幕亮度

## ✨ 主要特性

### 🎯 **核心功能**

- **双手识别**：同时检测并区分左右手
- **音量控制**：左手手势控制系统音量（0-100%）
- **亮度控制**：右手手势控制屏幕亮度（1-100%）
- **实时反馈**：双控制条显示当前音量和亮度状态
- **平滑控制**：使用中值滤波和平滑过渡算法减少抖动

### 🔧 **技术特点**

- **MediaPipe手部检测**：精确的21个关键点检测
- **距离归一化**：基于手掌宽度的自适应距离计算
- **多API支持**：音量控制使用pycaw，亮度控制支持WMI和PowerShell
- **模块化设计**：分离的手部检测、音量控制、亮度控制模块

## 🚀 使用方法

### 📦 **快速安装**

1. **自动安装依赖**（推荐）：

   ```bash
   python install_dependencies.py
   ```

2. **手动安装依赖**：

   ```bash
   # 必需依赖
   pip install opencv-python mediapipe numpy pycaw comtypes Pillow

   # 可选依赖（更好的亮度控制）
   pip install wmi
   ```

### 🎮 **运行程序**

```bash
python DualHandController.py
```

### 🖐️ **操作说明**

#### 👈 **左手控制音量**

- 🤏 **降低音量**：将左手拇指和食指靠近
- 🖐️ **提高音量**：将左手拇指和食指分开
- 📊 **音量显示**：左侧绿色控制条

#### 👉 **右手控制亮度**

- 🤏 **降低亮度**：将右手拇指和食指靠近
- 🖐️ **提高亮度**：将右手拇指和食指分开
- 📊 **亮度显示**：右侧黄色控制条

#### 🚪 **退出程序**

- 按 `q` 键退出

## 🖼️ **界面说明**

### 📊 **UI元素**

- **左侧绿色条**：实时显示音量百分比（左手控制）
- **右侧黄色条**：实时显示亮度百分比（右手控制）
- **手部标识**：显示检测到的左右手状态
- **FPS计数器**：显示程序运行帧率
- **状态信息**：显示手部检测和控制状态

### 🎯 **视觉反馈**

- **手部轮廓**：绿色边框显示检测到的手部区域
- **关键点连线**：紫色线条连接拇指和食指
- **实时数值**：在手部附近显示当前控制值

## 🔧 **技术实现**

### 📁 **项目结构**

```bash
手势双重控制/
├── DualHandController.py      # 主控制器
├── HandTrackingModule.py      # 手部检测模块
├── VolumeController.py        # 音量控制模块
├── BrightnessController.py    # 亮度控制模块
├── install_dependencies.py    # 依赖安装脚本
└── README.md                  # 项目说明
```

### 🎯 **核心算法**

#### 1. **手部检测与识别**

- 使用MediaPipe检测最多2只手
- 通过`multi_handedness`区分左右手
- 提取21个关键点坐标

#### 2. **距离计算与归一化**

```python
# 计算拇指(4)和食指(8)之间的距离
finger_distance = math.hypot(x2 - x1, y2 - y1)

# 使用手掌宽度进行归一化
scaling_factor = 80 / reference_length
normalized_distance = finger_distance * scaling_factor
```

#### 3. **控制值映射**

```python
# 音量映射 (0.0-1.0)
volume = np.interp(normalized_distance, [30, 200], [0.0, 1.0])

# 亮度映射 (1-100)
brightness = np.interp(normalized_distance, [30, 200], [1, 100])
```

#### 4. **平滑处理**

- 中值滤波减少抖动
- 指数平滑过渡
- 历史记录缓冲

## ⚠️ **注意事项**

### 🔒 **权限要求**

- **音量控制**：需要访问系统音频设备
- **亮度控制**：可能需要管理员权限（取决于系统配置）

### 💻 **兼容性**

- **操作系统**：Windows 10/11（主要支持）
- **Python版本**：3.7+
- **摄像头**：需要可用的摄像头设备
- **硬件**：支持软件亮度控制的显示器

### 🐛 **常见问题**

1. **音量控制不工作**
   - 检查音频设备是否正常
   - 确认pycaw库安装正确
   - 重启程序或重新插拔音频设备

2. **亮度控制不工作**
   - 尝试以管理员身份运行程序
   - 确认显示器支持软件亮度控制
   - 检查WMI服务是否正常运行

3. **手部检测不准确**
   - 确保光线充足
   - 保持手部在摄像头视野内
   - 调整摄像头角度和距离
   - 避免复杂背景干扰

4. **程序运行缓慢**
   - 关闭不必要的后台程序
   - 降低摄像头分辨率
   - 调整检测置信度参数

## 🎯 **使用技巧**

### 📏 **最佳使用距离**

- 距离摄像头 50-80cm
- 确保双手都在视野内
- 保持手部动作平稳

### 🎨 **手势建议**

- 使用拇指和食指进行控制
- 动作要平稳，避免快速移动
- 可以单手或双手同时操作

### ⚡ **性能优化**

- 确保摄像头驱动正常
- 调整检测置信度参数
- 关闭其他占用摄像头的程序

## 📝 **更新日志**

### v1.0 (2024-07-21)

- ✅ 实现双手手势识别
- ✅ 左手控制音量功能
- ✅ 右手控制亮度功能
- ✅ 模块化代码架构
- ✅ 实时UI反馈
- ✅ 平滑控制算法
- ✅ 自动依赖安装脚本

## 🤝 **贡献指南**

欢迎提交Issue和Pull Request来改进这个项目！

## 📄 **许可证**

本项目采用MIT许可证。

---

**🎉 享受您的手势双重控制体验！**
