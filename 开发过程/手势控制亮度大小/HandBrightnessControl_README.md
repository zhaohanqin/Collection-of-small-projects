# 🌟 手势屏幕亮度控制器

## 📖 项目简介

基于原有的 `HandVolumeControl.py` 文件创建的手势控制屏幕亮度程序。保持了原有的核心手势识别逻辑和交互方式，将音量控制功能替换为屏幕亮度控制功能。

## ✨ 主要特性

### 🎯 **核心功能**
- **手势识别**：使用MediaPipe进行精确的手部检测
- **亮度控制**：通过手指间距离控制屏幕亮度
- **人脸检测**：使用人脸宽度进行距离归一化
- **实时预览**：双窗口显示（详细视图 + 简洁视图）

### 🔧 **技术特点**
- **平滑控制**：使用中值滤波和平滑过渡算法
- **多种API支持**：WMI + Windows API + PowerShell备用方案
- **实时反馈**：亮度条、FPS计数器、状态显示

## 🚀 使用方法

### 📦 **环境要求**

```bash
# 必需依赖
pip install opencv-python mediapipe numpy wmi

# 可选依赖（如果WMI不可用）
# Windows系统自带PowerShell，无需额外安装
```

### 🎮 **操作说明**

1. **启动程序**
   ```bash
   python HandBrightnessControl.py
   ```

2. **手势控制**
   - 🤏 **降低亮度**：将拇指和食指靠近
   - 🖐️ **提高亮度**：将拇指和食指分开
   - 👤 **人脸检测**：保持面部在摄像头视野内以获得更精确的控制

3. **退出程序**
   - 按 `q` 键退出

### 🖼️ **界面说明**

#### 📊 **详细视图窗口**
- 显示完整的手部关键点和连线
- 显示人脸网格和关键点
- 显示手指距离和归一化值
- 显示人脸检测状态

#### 🎯 **简洁视图窗口**
- 仅显示拇指、食指和连线
- 显示亮度控制的核心信息
- 更清爽的视觉体验

#### 📈 **UI元素**
- **黄色亮度条**：实时显示当前亮度百分比
- **FPS计数器**：显示程序运行帧率
- **状态信息**：显示人脸检测和手势识别状态

## 🔧 技术实现

### 🎯 **核心算法保持不变**
- `HandDetector` 类：手部检测和关键点识别
- `findDistance` 方法：计算拇指和食指间距离
- 人脸检测和宽度计算：用于距离归一化
- 平滑处理算法：减少抖动和突变

### 🔄 **主要修改内容**

#### 1. **亮度控制类**
```python
class BrightnessController:
    - get_brightness()    # 获取当前亮度
    - set_brightness()    # 设置屏幕亮度
```

#### 2. **API调用替换**
- **原来**：`pycaw` 音频控制API
- **现在**：`wmi` + Windows API + PowerShell

#### 3. **变量名更新**
- `VolumeController` → `BrightnessHandController`
- `volume` → `brightness`
- `volBar` → `brightnessBar`
- `volPer` → `brightnessPer`

#### 4. **UI颜色调整**
- 亮度条使用黄色 `(255, 255, 0)` 代替绿色
- 更直观地表示亮度概念

### 🛠️ **亮度控制实现**

#### 🥇 **方案一：WMI (推荐)**
```python
# 使用Windows WMI接口
c = wmi.WMI(namespace='wmi')
brightness_methods = c.WmiMonitorBrightnessMethods()[0]
brightness_methods.WmiSetBrightness(brightness, 0)
```

#### 🥈 **方案二：PowerShell备用**
```python
# 使用PowerShell命令
cmd = f'powershell.exe -Command "(Get-WmiObject -Namespace root/WMI -Class WmiMonitorBrightnessMethods).WmiSetBrightness(1,{brightness})"'
subprocess.run(cmd, shell=True)
```

## 📋 **功能对比**

| 功能 | 原版 (音量控制) | 新版 (亮度控制) |
|------|----------------|----------------|
| 手势识别 | ✅ 保持不变 | ✅ 保持不变 |
| 人脸检测 | ✅ 保持不变 | ✅ 保持不变 |
| 距离计算 | ✅ 保持不变 | ✅ 保持不变 |
| 平滑处理 | ✅ 保持不变 | ✅ 保持不变 |
| 控制目标 | 🔊 系统音量 | 🌟 屏幕亮度 |
| API接口 | `pycaw` | `wmi` + 备用方案 |
| UI颜色 | 绿色 | 黄色 |
| 控制范围 | 0-100% | 1-100% (避免黑屏) |

## ⚠️ **注意事项**

### 🔒 **权限要求**
- 需要管理员权限来控制屏幕亮度
- 某些笔记本电脑可能需要特殊驱动支持

### 💻 **兼容性**
- **支持系统**：Windows 10/11
- **硬件要求**：支持WMI亮度控制的显示器
- **摄像头**：需要可用的摄像头设备

### 🐛 **常见问题**

1. **亮度无法调节**
   - 检查是否以管理员身份运行
   - 确认显示器支持软件亮度控制
   - 尝试更新显卡驱动

2. **WMI初始化失败**
   - 程序会自动切换到PowerShell备用方案
   - 确保Windows管理工具服务正常运行

3. **手势识别不准确**
   - 确保光线充足
   - 保持手部在摄像头视野内
   - 调整摄像头角度和距离

## 🎯 **使用技巧**

### 📏 **最佳使用距离**
- 距离摄像头 50-80cm
- 确保整个手部和面部都在视野内

### 🎨 **手势建议**
- 使用拇指和食指进行控制
- 动作要平稳，避免快速移动
- 可以通过人脸检测状态判断最佳位置

### ⚡ **性能优化**
- 关闭不必要的后台程序
- 确保摄像头驱动正常
- 调整检测置信度参数

## 📝 **更新日志**

### v1.0 (2024-07-12)
- ✅ 基于 `HandVolumeControl.py` 创建
- ✅ 实现屏幕亮度控制功能
- ✅ 保持原有手势识别逻辑
- ✅ 添加多种亮度控制API支持
- ✅ 更新UI颜色和标识

---

**🎉 享受您的手势亮度控制体验！**
